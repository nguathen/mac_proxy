global
    log stdout format raw local0 info
    maxconn 4096
    daemon

defaults
    log global
    mode tcp
    option tcplog
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms
    retries 3

# Frontend cho HAProxy 2 - cổng 7892
frontend socks_frontend_2
    bind *:7892
    mode tcp
    default_backend socks_backend_2

# Backend với WireGuard 18182 và fallback sang Cloudflare WARP 8111
backend socks_backend_2
    mode tcp
    balance roundrobin
    option tcp-check
    
    # WireGuard proxy chính
    server wg2 127.0.0.1:18182 check inter 3000 fall 2 rise 2
    
    # Cloudflare WARP fallback
    server warp_fallback 127.0.0.1:8111 check inter 3000 fall 2 rise 2 backup

